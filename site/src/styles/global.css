@tailwind base;
@tailwind components;
@tailwind utilities;

/* Screen reader only utility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip-path: inset(50%);
  white-space: nowrap;
  border: 0;
}

.sr-only:focus {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

@layer base {
  /* 
    Note: :root variables for colors are defined in Layout.astro 
    to prevent FOUC (Flash of Unstyled Content).
  */

  body {
    background-color: rgb(
      var(--gradient-base-r),
      var(--gradient-base-g),
      var(--gradient-base-b)
    );
  }

  html.dark nav,
  html.dark .nav-links a,
  html.dark footer {
    color: #fff;
  }

  /* Regular links */
  a {
    color: inherit;
    text-decoration: underline;
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
    text-decoration-color: currentColor;
    transition: color 0.2s ease, text-decoration-color 0.2s ease;
  }

  a:hover,
  a:focus-visible {
    text-decoration: none;
  }

  /* Navigation links */
  nav a {
    text-decoration: none;
  }

  nav a:hover,
  nav a:focus-visible,
  nav a.underline {
    text-decoration: underline;
  }

  /* Dark mode defaults for main content elements */
  /* Using high specificity to override default browser styles and some utilities if needed */
  html.dark main,
  html.dark main h1,
  html.dark main h2,
  html.dark main h3,
  html.dark main h4,
  html.dark main p,
  html.dark main a,
  html.dark main li {
    color: #d1d5db; /* readable light gray */
  }

  html.dark main a {
    color: #60a5fa;
  }

  html.dark main ul > li::marker {
    color: #9ca3af;
  }

  html.dark h1,
  html.dark h2,
  html.dark h3,
  html.dark h4,
  html.dark h5,
  html.dark h6 {
    color: #f9fafb;
  }
}

@layer components {
  /* Desktop gradient: soft fade with wide solid center */
  .gradient-overlay {
    --grad: rgba(var(--gradient-base-r), var(--gradient-base-g), var(--gradient-base-b));
    background: linear-gradient(
      to right,
      transparent 0%,
      color-mix(in srgb, var(--grad) 3%, transparent) 8%,
      color-mix(in srgb, var(--grad) 8%, transparent) 12%,
      color-mix(in srgb, var(--grad) 15%, transparent) 16%,
      color-mix(in srgb, var(--grad) 30%, transparent) 20%,
      color-mix(in srgb, var(--grad) 50%, transparent) 25%,
      color-mix(in srgb, var(--grad) 70%, transparent) 30%,
      color-mix(in srgb, var(--grad) 85%, transparent) 35%,
      color-mix(in srgb, var(--grad) 95%, transparent) 40%,
      color-mix(in srgb, var(--grad) 100%, transparent) 45%,
      color-mix(in srgb, var(--grad) 100%, transparent) 50%,
      color-mix(in srgb, var(--grad) 100%, transparent) 55%,
      color-mix(in srgb, var(--grad) 95%, transparent) 60%,
      color-mix(in srgb, var(--grad) 85%, transparent) 65%,
      color-mix(in srgb, var(--grad) 70%, transparent) 70%,
      color-mix(in srgb, var(--grad) 50%, transparent) 75%,
      color-mix(in srgb, var(--grad) 30%, transparent) 80%,
      color-mix(in srgb, var(--grad) 15%, transparent) 84%,
      color-mix(in srgb, var(--grad) 8%, transparent) 88%,
      color-mix(in srgb, var(--grad) 3%, transparent) 92%,
      transparent 100%
    );
  }

  html.dark .gradient-overlay {
    background: linear-gradient(
      to right,
      transparent 0%,
      color-mix(in srgb, var(--grad) 1%, transparent) 8%,
      color-mix(in srgb, var(--grad) 5%, transparent) 12%,
      color-mix(in srgb, var(--grad) 10%, transparent) 16%,
      color-mix(in srgb, var(--grad) 30%, transparent) 20%,
      color-mix(in srgb, var(--grad) 50%, transparent) 25%,
      color-mix(in srgb, var(--grad) 70%, transparent) 30%,
      color-mix(in srgb, var(--grad) 85%, transparent) 35%,
      color-mix(in srgb, var(--grad) 95%, transparent) 40%,
      var(--grad) 45%,
      var(--grad) 50%,
      var(--grad) 55%,
      color-mix(in srgb, var(--grad) 95%, transparent) 60%,
      color-mix(in srgb, var(--grad) 85%, transparent) 65%,
      color-mix(in srgb, var(--grad) 70%, transparent) 70%,
      color-mix(in srgb, var(--grad) 50%, transparent) 75%,
      color-mix(in srgb, var(--grad) 30%, transparent) 80%,
      color-mix(in srgb, var(--grad) 10%, transparent) 84%,
      color-mix(in srgb, var(--grad) 5%, transparent) 88%,
      color-mix(in srgb, var(--grad) 1%, transparent) 92%,
      transparent 100%
    );
  }

  /* Tablet: tighten gradient to preserve content area */
  @media (max-width: 1024px) {
    .gradient-overlay {
      background: linear-gradient(
        to right,
        transparent 0%,
        color-mix(in srgb, var(--grad) 5%, transparent) 5%,
        color-mix(in srgb, var(--grad) 15%, transparent) 10%,
        color-mix(in srgb, var(--grad) 40%, transparent) 15%,
        color-mix(in srgb, var(--grad) 70%, transparent) 20%,
        color-mix(in srgb, var(--grad) 100%, transparent) 25%,
        color-mix(in srgb, var(--grad) 100%, transparent) 50%,
        color-mix(in srgb, var(--grad) 100%, transparent) 75%,
        color-mix(in srgb, var(--grad) 70%, transparent) 80%,
        color-mix(in srgb, var(--grad) 40%, transparent) 85%,
        color-mix(in srgb, var(--grad) 15%, transparent) 90%,
        color-mix(in srgb, var(--grad) 5%, transparent) 95%,
        transparent 100%
      );
    }

    html.dark .gradient-overlay {
      background: linear-gradient(
        to right,
        transparent 0%,
        color-mix(in srgb, var(--grad) 5%, transparent) 5%,
        color-mix(in srgb, var(--grad) 15%, transparent) 10%,
        color-mix(in srgb, var(--grad) 40%, transparent) 15%,
        color-mix(in srgb, var(--grad) 70%, transparent) 20%,
        var(--grad) 25%,
        var(--grad) 50%,
        var(--grad) 75%,
        color-mix(in srgb, var(--grad) 70%, transparent) 80%,
        color-mix(in srgb, var(--grad) 40%, transparent) 85%,
        color-mix(in srgb, var(--grad) 15%, transparent) 90%,
        color-mix(in srgb, var(--grad) 5%, transparent) 95%,
        transparent 100%
      );
    }
  }

  /* Mobile: aggressive tight gradient to preserve text area */
  @media (max-width: 640px) {
    .gradient-overlay {
      background: linear-gradient(
        to right,
        transparent 0%,
        color-mix(in srgb, var(--grad) 15%, transparent) 3%,
        color-mix(in srgb, var(--grad) 50%, transparent) 8%,
        color-mix(in srgb, var(--grad) 80%, transparent) 12%,
        color-mix(in srgb, var(--grad) 92%, transparent) 20%,
        color-mix(in srgb, var(--grad) 100%, transparent) 50%,
        color-mix(in srgb, var(--grad) 92%, transparent) 80%,
        color-mix(in srgb, var(--grad) 80%, transparent) 88%,
        color-mix(in srgb, var(--grad) 50%, transparent) 92%,
        color-mix(in srgb, var(--grad) 15%, transparent) 97%,
        transparent 100%
      );
    }

    html.dark .gradient-overlay {
      background: linear-gradient(
        to right,
        transparent 0%,
        color-mix(in srgb, var(--grad) 15%, transparent) 3%,
        color-mix(in srgb, var(--grad) 50%, transparent) 8%,
        color-mix(in srgb, var(--grad) 80%, transparent) 12%,
        color-mix(in srgb, var(--grad) 92%, transparent) 20%,
        color-mix(in srgb, var(--grad) 95%, transparent) 50%,
        color-mix(in srgb, var(--grad) 92%, transparent) 80%,
        color-mix(in srgb, var(--grad) 80%, transparent) 88%,
        color-mix(in srgb, var(--grad) 50%, transparent) 92%,
        color-mix(in srgb, var(--grad) 15%, transparent) 97%,
        transparent 100%
      );
    }
  }

  /* Article prose styling */
  article.prose {
    max-width: 65ch;
    line-height: 1.7;
  }

  @media (min-width: 1024px) {
    article.prose {
      max-width: 75ch;
    }
  }

  /* Obsidian-like callout styling for blockquotes */
  .prose blockquote {
    border-left: 4px solid var(--tw-prose-quote-borders);
    background-color: rgba(209, 213, 219, 0.08);
    padding: 0.75rem 2.5rem;
    margin: 1.25rem 0;
    border-radius: 0.375rem;
    position: relative;
  }

  .prose blockquote::before {
    content: "";
    position: absolute;
    left: calc(4px + 1.25rem);
    transform: translateX(-50%);
    top: 0.6rem;
    font-size: 1rem;
  }

  .prose blockquote p:first-child {
    margin-top: 0;
  }

  .prose blockquote p:last-child {
    margin-bottom: 0;
  }

  html.dark .prose blockquote {
    background-color: rgba(55, 65, 81, 0.32);
    border-left-color: var(--tw-prose-quote-borders);
  }

  html.dark .prose blockquote::before {
    content: "";
  }

  /* Explicit callout blocks */
  .callout {
    display: block;
    padding: 0.75rem 2.5rem;
    border-radius: 0.375rem;
    margin: 1rem 0;
    position: relative;
  }

  .callout .callout-heading {
    font-weight: 700;
    margin-bottom: 0.25rem;
  }

  .callout::before {
    content: "";
    position: absolute;
    left: calc(4px + 1.25rem);
    transform: translateX(-50%);
    top: 0.6rem;
  }

  .callout.note {
    border-left: 4px solid #2563eb;
    background: rgba(37, 99, 235, 0.06);
  }

  .callout.warning {
    border-left: 4px solid #f59e0b;
    background: rgba(245, 158, 11, 0.06);
  }

  .callout.success {
    border-left: 4px solid #10b981;
    background: rgba(16, 185, 129, 0.06);
  }

  .callout :where(p, ul, ol, pre, code) {
    margin: 0.25rem 0;
  }

  /* Custom dash marker for unordered lists */
  ul.list-dash > li::marker {
    content: "- ";
    font-weight: bold;
  }
}

@layer utilities {
  /* Dark-mode utility overrides */
  html.dark .text-gray-700 {
    color: #d1d5db; /* gray-300 */
  }

  html.dark .text-gray-800 {
    color: #e5e7eb; /* gray-200 */
  }

  html.dark .text-gray-900 {
    color: #ffffff; /* white for primary headings */
  }

  html.dark .text-gray-600 {
    color: #9ca3af; /* gray-400 */
  }

  html.dark .text-gray-500,
  html.dark .text-gray-400 {
    color: #9ca3af; /* gray-400 */
  }

  html.dark .bg-gray-100 {
    background-color: #111827; /* dark badge bg */
  }

  html.dark .text-gray-700.bg-gray-100 {
    color: #e5e7eb; /* badge text */
  }

  html.dark .border-t {
    border-color: rgba(255, 255, 255, 0.06);
  }
}
