---
import Layout from "../layouts/Layout.astro";
import { Image } from "astro:assets";
---

<Layout title="Misc">
  <main class="max-w-4xl mx-auto">
    <h1 class="text-2xl font-bold mb-6">
      <span class="text-orange-500 dark:text-orange-400">*</span> misc
    </h1>

    <div class="space-y-8">
      <section>
        <div class="grid gap-6 sm:grid-cols-2">
          <a href="/now" class="group block p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-orange-500 transition-colors">
            <h2 class="text-lg font-semibold group-hover:text-orange-500 transition-colors">/now</h2>
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">What I'm currently up to</p>
          </a>
          
          <a href="/uses" class="group block p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-orange-500 transition-colors">
            <h2 class="text-lg font-semibold group-hover:text-orange-500 transition-colors">/uses</h2>
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">My hardware and software tools</p>
          </a>
        </div>
      </section>

      <section>
        <h2 class="text-xl font-semibold mb-3">Books I'm reading</h2>
        <div>
          <ul>
            <li>"Crucial Conversations" by Kerry Patterson</li>
            <li>"How to Win Friends and Influence People" by Dale Carnegie</li>
            <li>"Designing Data-Intensive Applications" by Martin Kleppmann</li>
            <li>Loads of different fantasy web novels :)</li>
          </ul>
        </div>
      </section>

      <section>
        <h2 class="text-xl font-semibold mb-3">Random</h2>
        <p>Random things.</p>
        <div>
          I'm learning Welsh on Duolingo! <br />
          My current streak: <span id="streak-number" aria-live="polite"
          ></span>ðŸ”¥
          <div class="mt-2">
            <a
              href="https://github.com/pixel-87/duo-streak-widget"
              rel="ed.thomas.dev"
            >
              <img
                loading="lazy"
                decoding="async"
                src="https://api.pixel-87.uk/api/duolingo/button?username=Edward527516"
                alt="Ed's Duolingo"
                title="Ed's Duolingo"
              />
            </a>
          </div>
        </div>

        <section>
          <h2 class="text-xl font-semibold mb-3">About this site</h2>
          <div class="prose max-w-none">
            <p>
              This site is built with <a href="https://astro.build/">Astro</a> and
              <a href="https://nixos.org/">Nix</a>.
              <br />
              I self host it on a K3s <a
                href="https://github.com/pixel-87/nixos-config">homelab</a
              >.
            </p>

            <p>
              The site is packaged using a <a
                href="https://www.nixos.wiki/Flakes.com/">Nix flake</a
              >, producing both a package and an OCI container, uploaded to the <a
                href="https://github.com/features/packages"
                >GitHub Container Registry</a
              > using <a
                href="https://github.com/pixel-87/ed-thomas.dev/blob/main/.github/workflows/deploy.yml"
                >GitHub Actions</a
              >.
            </p>

            <p>
              There is also a <a href="/rss.xml">RSS feed</a> for this site.
            </p>
            <p>
              The source code is available on <a
                href="https://github.com/pixel-87/ed-thomas.dev">GitHub</a
              >.
            </p>

            <figure class="my-6">
              <Image
                src="/images/lighthouse-100.png"
                alt="Lighthouse 100 score screenshot"
                class="w-full max-w-md mx-auto rounded shadow-md"
                width={800}
                height={450}
                loading="lazy"
                decoding="async"
              />
            </figure>
          </div>
        </section>
      </section>
    </div>
    <script>
      // Minimal fetch to read an integer from a raw gist and display it
      const _g =
        "https://gist.githubusercontent.com/pixel-87/f4db826c7a94c24c6dde14ce28cd86dd/raw";
      const el = document.getElementById("streak-number");
      if (el) {
        fetch(_g, { cache: "no-store" })
          .then((r) => (r.ok ? r.text() : Promise.reject(r.status)))
          .then((t) => t.trim())
          .then((t) => {
            const n = parseInt(t, 10);
            el.textContent = Number.isFinite(n) ? String(n) : "?";
          })
          .catch(() => {
            el.textContent = "?";
          });
      }
    </script>
  </main>
</Layout>
